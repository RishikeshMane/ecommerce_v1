<div class="container p-1">

    <div id="headingTable" class="row pt-4 eCommerce-sidebar-margin-expand">
        <div class="col-2">
            <h4 class="eCommerce-register-label">Order Date :</h4>
        </div>

        <div class="col-4">
            <div class="row">
                <div class="col-3">
                    <button class="btn eCommerce-nav-button-change d-flex justify-content-center btn-sm" (click)="from.toggle()">From&nbsp;<i class="bi bi-calendar-month"></i>&nbsp;<i class="bi bi-caret-down-square-fill"></i></button>   
                </div>
                <div class="col-3">
                    <input id='fromDate' type="text" readonly ngbDatepicker placeholder="yyyy-mm-dd" (dateSelect)="onFromDateSelect($event)" #from="ngbDatepicker"/>
                </div>
            </div>
        </div>

        <div class="col-4">
            <div class="row">
                <div class="col-3">
                    <button class="btn eCommerce-nav-button-change d-flex justify-content-center btn-sm" (click)="to.toggle()">To&nbsp;&nbsp;<i class="bi bi-calendar-month"></i>&nbsp;&nbsp;<i class="bi bi-caret-down-square-fill"></i></button>
                </div>
                <div class="col-3">
                    <input id='toDate' type="text" readonly ngbDatepicker placeholder="yyyy-mm-dd" (dateSelect)="onToDateSelect($event)" #to="ngbDatepicker"/>
                </div>  
            </div>
        </div>
    </div>

    <div id="headingTable2" class="row pt-4 eCommerce-sidebar-margin-expand">
        <div class="col-2">

        </div>

        <div class="col-4">
            <input class="form-check-input" name="cod" type="checkbox" style="border: 0.05em solid currentColor;" [(ngModel)]="isCashOnDelivery" (change)="onCashOnDelivery($event)"/>
            &nbsp;
            <label class="form-check-label"><b>Show only Cash on Delivery</b></label>
        </div>        
    </div>      
    <hr/>

    <div id="payments" class="col-2">
        <h5 class="eCommerce-register-label"><b><u>My Payments</u></b></h5>
    </div>
    
    <br>

    <div id="paymentTable" class="col-md-12 mb-3 eCommerce-sidebar-margin-expand" style="width: auto;">
        <ngx-datatable class='bootstrap no-detail-row material eCommerce-datatable-material container striped row-border' [footerHeight]="50" [rowHeight]="'auto'"    
                        style="border: 1px solid #121212e6;" [rows]='paymentData' [count]="paymentCount" [limit]="paymentLimit" [rowHeight]="50">

            <ngx-datatable-column name="ID" prop="id" [canAutoResize]="true" [maxWidth]="40">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>    
                    <div class="text-left">    
                        <a class="mr-2 eCommerce-anchor" href="javascript:void(0);" data-bs-toggle="modal" data-bs-target="#showPayment" ngbTooltip="{{row.id}}" (click)="onOrderSelect(row)">{{row.id}}</a> 
                    </div>
                </ng-template>                    
            </ngx-datatable-column>

            <ngx-datatable-column name="OrderId" prop="userOrderid" [canAutoResize]="true" [resizeable]="true" [width]="100" [maxWidth]="100">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>    
                    <div class="text-left">    
                        <a class="mr-2 eCommerce-anchor" href="javascript:void(0);" data-bs-toggle="modal" data-bs-target="#showPayment" ngbTooltip="{{row.userOrderid}}" (click)="onOrderSelect(row)">{{row.userOrderid}}</a> 
                    </div>    
                </ng-template>                 
            </ngx-datatable-column>

            <ngx-datatable-column name="Price(₹)" prop="price" [canAutoResize]="true" [resizeable]="true" [width]="80" [maxWidth]="80">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>    
                    <div class="text-left">    
                        <a ngbTooltip="{{row.price}}">{{row.price}}</a> 
                    </div>    
                </ng-template>                 
            </ngx-datatable-column>
            
            <ngx-datatable-column name="OrderDate" prop="orderDate" [canAutoResize]="true" [resizeable]="true" [width]="123" [maxWidth]="123">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>    
                    <div class="text-left">    
                        <a ngbTooltip="{{row.orderDate}}">{{row.orderDate}}</a> 
                    </div>    
                </ng-template>                 
            </ngx-datatable-column>

            <ngx-datatable-column name="DeliveryStatus" prop="deliveryStatus" [canAutoResize]="true" [resizeable]="true" [width]="130" [maxWidth]="130">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>    
                    <div class="text-left">    
                        <a ngbTooltip="{{row.deliveryStatus}}">{{row.deliveryStatus}}</a> 
                    </div>    
                </ng-template>                 
            </ngx-datatable-column>

            <ngx-datatable-column name="Payment(₹)" prop="payment" [canAutoResize]="true" [resizeable]="true" [width]="100" [maxWidth]="100">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>    
                    <div class="text-left">    
                        <a ngbTooltip="{{row.payment}}">{{row.payment}}</a> 
                    </div>    
                </ng-template>                 
            </ngx-datatable-column>            

            <ngx-datatable-column name="Payment Status" prop="paymentStatus" [canAutoResize]="true" [resizeable]="true" [width]="130" [maxWidth]="130">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>    
                    <div class="text-left">    
                        <a class="mr-2 eCommerce-anchor" href="javascript:void(0);" data-bs-toggle="modal" data-bs-target="#showPayment" ngbTooltip="{{row.paymentStatus}}" (click)="onOrderSelect(row)">{{row.paymentStatus}}</a> 
                    </div>    
                </ng-template>                              
            </ngx-datatable-column>

            <ngx-datatable-column name="Payment Date" prop="paymentDate" [canAutoResize]="true" [resizeable]="true" [width]="168" [maxWidth]="168">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>    
                    <div class="text-left">    
                        <a ngbTooltip="{{row.paymentDate}}">{{row.paymentDate}}</a> 
                    </div>    
                </ng-template>
            </ngx-datatable-column>
            
            <ngx-datatable-column name="TransactionId" prop="transactionId" [canAutoResize]="true" [resizeable]="true" [width]="120" [maxWidth]="120">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>    
                    <div class="text-left">    
                        <a ngbTooltip="{{row.transactionId}}">{{row.transactionId}}</a> 
                    </div>    
                </ng-template>
            </ngx-datatable-column>
            
            <ngx-datatable-column name="Comments" prop="comments" [canAutoResize]="true" [resizeable]="true" [width]="commentWidth" [maxWidth]="commentWidth">
                <ng-template let-row="row" let-expanded="expanded" ngx-datatable-cell-template>    
                    <div class="text-left">    
                        <a ngbTooltip="{{row.comments}}">{{row.comments}}</a> 
                    </div>    
                </ng-template>
            </ngx-datatable-column>               

        </ngx-datatable>
    </div>

    <!-- Modal Order -->
    <form enctype="multipart/form-data">
        <div class="modal fade" id="showPayment" tabindex="-1" aria-labelledby="showOrderLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg" role="document">
                <div class="modal-content eCommerce-background">
                    <div class="modal-header d-flex justify-content-center eCommerce-register-navigation" style="height: 10px;">
                        <h3 class="modal-title fs-5" id="userOrderLabel">{{this.supplierPaymentDetail.userOrderId}}</h3>                
                    </div>
                    
                    <div class="modal-body eCommerce-background eCommerce-round-control">
    
                        <div class="container-fluid eCommerce-round-control eCommerce-box-shadow">
                            <!-- Delivery date / Delivery status -->
                            <div class="row">
                                <div class="col-md-2" style="margin-top: 13px;"> 
                                    <label class="eCommerce-anchor-background eCommerce-control-top-padding">Order Date : </label>
                                </div>
                                <div class="col-md-4" style="margin-top: 13px;">
                                    <input type="text" #orderDateLabel="ngModel" class="form-control eCommerce-round-control" readonly name="orderDate" [(ngModel)]="supplierPaymentDetail.orderDate"/>
                                </div>
                                <div class="col-md-2" style="margin-top: 13px;"> 
                                    <label class="eCommerce-anchor-background eCommerce-control-top-padding">DeliveryStatus:</label>
                                </div>
                                <div class="col-md-4" style="margin-top: 13px;">
                                    <input type="text" #deliveryStatusLabel="ngModel" class="form-control eCommerce-round-control" readonly name="deliveryStatus" [(ngModel)]="supplierPaymentDetail.deliveryStatus"/>
                                </div>
                            </div>
                            <!-- Delivery date / Delivery status -->

                            <!-- Price / Payment -->
                            <div class="row">
                                <div class="col-md-2" style="margin-top: 13px;"> 
                                    <label class="eCommerce-anchor-background eCommerce-control-top-padding">Price ( ₹ ) : </label>
                                </div>
                                <div class="col-md-4" style="margin-top: 13px;">
                                    <input type="text" #priceLabel="ngModel" class="form-control eCommerce-round-control" readonly name="price" [(ngModel)]="supplierPaymentDetail.price"/>
                                </div>

                                <div *ngIf="this.supplierPaymentDetail.userOrderId.indexOf('COD-') === 0" class="col-md-3" style="margin-top: 13px;"> 
                                    <label class="eCommerce-anchor-background eCommerce-control-top-padding">SupplierPayment( ₹ ) : </label>
                                </div>
                                <!--<div *ngIf="this.supplierPaymentDetail.userOrderId.indexOf('COD-') === 0" class="col-md-1"></div>-->
                                <div *ngIf="this.supplierPaymentDetail.userOrderId.indexOf('COD-') === 0" class="col-md-3" style="margin-top: 13px;">
                                    <input type="text" #supplierPaymentLabel="ngModel" class="form-control eCommerce-round-control" name="supplierPayment" [(ngModel)]="supplierPaymentDetail.supplierPayment"/>
                                </div>

                                <div *ngIf="this.supplierPaymentDetail.userOrderId.indexOf('COD-') !== 0" class="col-md-3" style="margin-top: 13px;"> 
                                    <label class="eCommerce-anchor-background eCommerce-control-top-padding">CompanyPayment( ₹ ) : </label>
                                </div>
                                <!--<div *ngIf="this.supplierPaymentDetail.userOrderId.indexOf('COD-') !== 0" class="col-md-1"></div>-->
                                <div *ngIf="this.supplierPaymentDetail.userOrderId.indexOf('COD-') !== 0" class="col-md-3" style="margin-top: 13px;">
                                    <input type="text" #companyPaymentLabel="ngModel" readonly class="form-control eCommerce-round-control" name="companyPayment" [(ngModel)]="supplierPaymentDetail.companyPayment"/>
                                </div>
                            </div>
                            <!-- Price / Payment -->
                            
                            <!-- Payment Status / Payment Date -->
                            <div class="row">
                                <div class="col-md-2" style="margin-top: 13px;"> 
                                    <label class="eCommerce-anchor-background eCommerce-control-top-padding">PaymentStatus:</label>
                                </div>
                                <div *ngIf="this.supplierPaymentDetail.userOrderId.indexOf('COD-') === 0 && this.supplierPaymentDetail.supplierPaymentStatus !== 'Payment Accepted'" class="col-md-4" style="margin-top: 10px">
                                    <select (change)="onSelectPaymentStatus(selectPaymentStatus.value)" style="width: 100%;" required [class.is-invalid]="true" #selectPaymentStatus="ngModel" class="custom-select eCommerce-control-padding" name="paymentStatus" [(ngModel)]="selectedPaymentStatus">
                                        <option *ngFor="let paymentStatus of paymentCODStatuses" title="{{paymentStatus}}">{{paymentStatus}}</option> 
                                    </select>
                                </div>
                                <div *ngIf="this.supplierPaymentDetail.userOrderId.indexOf('COD-') === 0 && this.supplierPaymentDetail.supplierPaymentStatus === 'Payment Accepted'" class="col-md-4" style="margin-top: 10px">
                                    <input type="text" #supplierPaymentStatusLabel="ngModel" readonly class="form-control eCommerce-round-control" name="supplierPaymentStatus" [(ngModel)]="supplierPaymentDetail.supplierPaymentStatus"/>
                                </div>                                
                                <div *ngIf="this.supplierPaymentDetail.userOrderId.indexOf('COD-') !== 0" class="col-md-4" style="margin-top: 10px">
                                    <select (change)="onSelectPaymentStatus(selectPaymentStatus.value)" style="width: 100%;" required [class.is-invalid]="true" #selectPaymentStatus="ngModel" class="custom-select eCommerce-control-padding" name="paymentStatus" [(ngModel)]="selectedPaymentStatus">
                                        <option *ngFor="let paymentStatus of paymentNonCODStatuses" title="{{paymentStatus}}">{{paymentStatus}}</option> 
                                    </select>
                                </div>
                                
                                <div class="col-2" style="margin-top: 21px;">
                                    <button class="btn eCommerce-nav-button-change d-flex justify-content-center btn-sm" [disabled]="disableDate==='true' ? true: false" (click)="paymentDate.toggle()">Payment&nbsp;Date&nbsp;<i class="bi bi-caret-down-square-fill"></i></button>
                                </div>
                                &nbsp;&nbsp;
                                <div class="col-3" style="margin-top: 21px;">
                                    <input id='paymentDate' type="text" value="{{dDate}}" readonly ngbDatepicker format="mm-dd-yyyy" placeholder="yyyy-mm-dd" (dateSelect)="onPaymentDateSelect($event)" #paymentDate="ngbDatepicker"/>
                                </div>                                
                            </div>
                            <!-- Payment Status / Payment Date -->

                            <!-- Transaction Id -->
                            <div class="row">
                                <div class="col-md-2" style="margin-top: 13px;"> 
                                    <label class="eCommerce-anchor-background eCommerce-control-top-padding">TransactionId:</label>
                                </div>
                                <div class="col-md-10" style="margin-top: 13px;">
                                    <input type="text" #transactionIdLabel="ngModel" class="form-control eCommerce-round-control" [readonly]="disableTransactionId==='true' ? true: false" placeholder="Please enter Transaction Id" name="transactionId" [(ngModel)]="supplierPaymentDetail.transactionId"/>
                                </div>
                            </div>
                            <!-- Transaction Id --> 

                            <!-- Comments -->
                            <div class="row">
                                <div class="col-md-2" style="margin-top: 13px;"> 
                                    <label class="eCommerce-anchor-background eCommerce-control-top-padding">Comments:</label>
                                </div>
                                <div class="col-md-10" style="margin-top: 13px;">
                                    <textarea #commentsLabel="ngModel" class="form-control eCommerce-round-control" placeholder="Please enter Bankname, other details" name="comments" [(ngModel)]="supplierPaymentDetail.comments"></textarea>
                                </div>
                            </div>
                            <!-- Comments -->                            

                            &nbsp;
                            <!-- Order Status / Payment -->
                            <div class="row">
                                <div class="col-md-2" style="margin-top: 13px;"> 
                                    <!--<label class="eCommerce-anchor-background eCommerce-control-top-padding">Order Status:</label>-->
                                </div>
                                <div class="col-md-4" style="margin-top: 13px">
                                    <!--<input type="text" #deliveryStatusLabel="ngModel" class="form-control eCommerce-round-control" readonly name="deliveryStatus" [(ngModel)]="supplierPaymentDetail.deliveryStatus"/>-->
                                </div> 
                                <div class="col-md-3" style="margin-top: 15px;">
                                    <button class="btn eCommerce-nav-button d-flex justify-content-center eCommerce-box-shadow" style="width:100%;" [attr.data-bs-dismiss]="'modal'" (click)="onUpdatePayments()">Update Payments</button>
                                </div>
        
                                <div class="col-md-3" style="margin-top: 15px;">
                                    <button class="btn d-flex justify-content-center eCommerce-box-shadow eCommerce-small-button-two" style="width:100%;" [attr.data-bs-dismiss]="'modal'" (click)="onCancel()">Cancel</button>
                                </div>  
                            </div>
                            <!-- Order Status / Payment -->                             

                            <br>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </form>
    <!-- Modal Order -->

</div>
